Site={mobileThreshold:601,skrollrHeight:7e3,init:function(){var i=this;$(window).resize(function(){i.onResize()}),Site.Layout.init(),Site.FlickrBackgrounds.init(),$(document).ready(function(){i.Organs.init(),i.Audio.init()})},onResize:function(){var i=this;i.Layout.onResize()},fixWidows:function(){$(".js-fix-widows").each(function(){var i=$(this).html();i=i.replace(/ ([^ ]*)$/,"&nbsp;$1"),$(this).html(i)})},isMobile:function(){return/Android|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent||navigator.vendor||window.opera)}},Site.Layout={init:function(){var i=this;i.layout()},onResize:function(){var i=this;i.layout()},layout:function(){$("#main-container").css("padding-top",Site.skrollrHeight)}},Site.Organs={init:function(){var i=this;i.$svg=$("#organs-svg"),i.initSkrollr(),i.bindMouse()},initSkrollr:function(){var i=this;i.skrollrInstance=skrollr.init({easing:"quadratic",skrollrBody:"main-container",forceHeight:!1})},bindMouse:function(){var i=this;Site.isMobile()?window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",function(t){var n=(t.gamma+100)/100,o=(t.beta+100)/100,e=10*n,a=10*o,r=10*(n-1),s=10*(o-1);i.skewImage(e,a,r,s)}):$(window).mousemove(function(t){var n=2*t.clientX/$(window).width(),o=2*t.clientY/$(window).height(),e=10*n,a=10*o,r=10*(n-1),s=10*(o-1);i.skewImage(e,a,r,s)})},skewImage:function(i,t,n,o){var e=this;$("#pngmask image").css({x:i+"%",y:t+"%"}),e.$svg.css("transform","perspective(500px) rotate3d("+n+", "+o+", "+o+", "+o*n/3+"deg)")}},Site.FlickrBackgrounds={init:function(){var i=this;i.searchText="desert+beach+paradise+tropical",i.imageNum=1,i.apiKey="6034ee53b5f4c9f50b9f7695b10b1298",$.getJSON("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+i.apiKey+"&text="+i.searchText+"&safe_search=1&content_type=1&media=photos&format=json&jsoncallback=?",function(t){if("ok"===t.stat){for(var n=1;n<=5;n++)for(var o=0;o<4;o++){var e=t.photos.photo[i.getRandomNumber(0,99)],a=i.constructUrl(e);if(i.doesImageExist(a)){i.setTropicalBackground(a,n);break}3===o&&i.setTropicalBackground("img/dist/island-beach.jpg",n)}$("body").css("overflow","initial"),$("#organs").css("opacity",1)}})},doesImageExist:function(i){var t=!1;return $.ajax({url:i,async:!1}).complete(function(i){200===i.status&&(t=!0)}).fail(function(){console.log("error")}),t},constructUrl:function(i){return"https://farm"+i.farm+".staticflickr.com/"+i.server+"/"+i.id+"_"+i.secret+"_h.jpg"},setTropicalBackground:function(i,t){$("#tropical-bg-"+t).attr("xlink:href",i)},getRandomNumber:function(i,t){return Math.floor(Math.random()*t)+i}},Site.Audio={init:function(){var i=this;i.playlistId="269048127",i.clientId="tlpRScA9YMg119ZZrHZ6lAWCom7Rje9c",i.playlistJson="http://api.soundcloud.com/playlists/"+i.playlistId+"?client_id="+i.clientId,i.getTrack()},getTrack:function(){var i=this;$.getJSON(i.playlistJson,function(t){if(t){var n=t.tracks,o=n[Math.floor(Math.random()*n.length)],e=o.stream_url+"?client_id="+i.clientId;i.addElement(e)}})},addElement:function(i){var t=this,n='<audio id="audio" src="'+i+'" preload="auto" loop volume="1.0"></audio>';$("body").prepend(n),$("#audio").trigger("play"),t.bindVolume()},bindVolume:function(){var i=document.getElementById("audio");$(window).on("scroll",function(){var t=($("#gradient-background").offset().top-$(window).scrollTop()+$("#gradient-background").height())/$("#gradient-background").height();i.volume=t>.1?t:.1})}},Site.init();
//# sourceMappingURL=/main.min.js.map