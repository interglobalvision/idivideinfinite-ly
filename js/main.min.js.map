{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","skrollrHeight","init","_this","this","$","window","resize","onResize","Layout","FlickrBackgrounds","document","ready","Organs","Audio","fixWidows","each","string","html","replace","isMobile","test","navigator","userAgent","vendor","opera","layout","css","$svg","initSkrollr","bindMouse","skrollrInstance","skrollr","easing","skrollrBody","forceHeight","DeviceOrientationEvent","addEventListener","event","distanceX","gamma","distanceY","beta","transX","transY","skewX","skewY","skewImage","mousemove","clientX","width","clientY","height","x","y","searchText","imageNum","apiKey","getJSON","data","stat","t","i","randomPhoto","photos","photo","getRandomNumber","url","constructUrl","doesImageExist","setTropicalBackground","response","ajax","async","complete","jqXHR","status","fail","console","log","farm","server","id","secret","bgNum","attr","min","max","Math","floor","random","playlistId","clientId","playlistJson","getTrack","tracks","randomTrack","length","trackUrl","stream_url","addElement","audioElem","prepend","trigger","bindVolume","audio","getElementById","on","volume","offset","top","scrollTop"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, document, Site, skrollr */\n\nSite = {\n  mobileThreshold: 601,\n  skrollrHeight: 7000,\n  init: function() {\n    var _this = this;\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    Site.Layout.init();\n    Site.FlickrBackgrounds.init();\n\n    $(document).ready(function() {\n      _this.Organs.init();\n      _this.Audio.init();\n    });\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    _this.Layout.onResize();\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n\n  isMobile: function() {\n    return (/Android|iPhone|iPad|iPod|BlackBerry/i).test(navigator.userAgent || navigator.vendor || window.opera);\n  },\n};\n\nSite.Layout = {\n  init: function() {\n    var _this = this;\n\n    _this.layout();\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    _this.layout();\n\n  },\n\n  layout: function() {\n    $('#main-container').css('padding-top', Site.skrollrHeight);\n  }\n};\n\nSite.Organs = {\n  init: function() {\n    var _this = this;\n\n    _this.$svg = $('#organs-svg');\n\n    _this.initSkrollr();\n    _this.bindMouse();\n  },\n\n  initSkrollr: function() {\n    var _this = this;\n\n    _this.skrollrInstance = skrollr.init({\n      easing: 'quadratic',\n      skrollrBody: 'main-container',\n      forceHeight: false\n    });\n  },\n\n  bindMouse: function() {\n    var _this = this;\n\n    if (Site.isMobile()) {\n      if (window.DeviceOrientationEvent) {\n        window.addEventListener('deviceorientation', function(event) {\n          // gamma and beta are values from -100 - 100\n          var distanceX = (event.gamma + 100) / 100;\n          var distanceY = (event.beta + 100) / 100;\n\n          var transX = distanceX * 10;\n          var transY = distanceY * 10;\n\n          var skewX = (distanceX - 1) * 10;\n          var skewY = (distanceY - 1) * 10;\n\n          // leaving this here for testing\n          //console.log('distanceX: ' + distanceX, 'distanceY: ' + distanceY, 'transX: ' + transX, 'transY: ' + transY, 'skewX: ' + skewX, 'skewY: ' + skewY);\n\n          _this.skewImage(transX, transY, skewX, skewY);\n        });\n      }\n    } else {\n      $(window).mousemove(function(event) {\n        var distanceX = (event.clientX * 2) / $(window).width();\n        var distanceY = (event.clientY * 2) / $(window).height();\n\n        var transX = distanceX * 10;\n        var transY = distanceY * 10;\n\n        var skewX = (distanceX - 1) * 10;\n        var skewY = (distanceY - 1) * 10;\n\n        // leaving this here for testing\n        //console.log('distanceX: ' + distanceX, 'distanceY: ' + distanceY, 'transX: ' + transX, 'transY: ' + transY, 'skewX: ' + skewX, 'skewY: ' + skewY);\n          \n        _this.skewImage(transX, transY, skewX, skewY);\n      });\n    }\n  },\n\n  skewImage: function(transX, transY, skewX, skewY) {\n    var _this = this;\n\n    $('#pngmask image').css({\n        'x': transX + '%',\n        'y': transY + '%',\n      });\n\n    _this.$svg.css('transform', 'perspective(500px) rotate3d(' + skewX + ', ' + skewY + ', ' + skewY + ', ' + ((skewY * skewX) / 3) + 'deg)');\n  }\n};\n\nSite.FlickrBackgrounds = {\n  init: function() {\n    var _this = this;\n\n    // This is the text used in the search query\n    _this.searchText = 'desert+beach+paradise+tropical';\n\n    // Element where the background is set\n    _this.imageNum = 1;\n\n    // Flickr API key\n    _this.apiKey = '6034ee53b5f4c9f50b9f7695b10b1298';\n\n    // Make the request\n    $.getJSON('https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=' + _this.apiKey + '&text=' + _this.searchText + '&safe_search=1&content_type=1&media=photos&format=json&jsoncallback=?', function(data) {\n\n      // If Flicker says YUZ\n      if(data.stat === 'ok') {\n        // We will get 5 images\n        for(var t = 1; t <= 5; t++) {\n          // We will attempt to find an existing image 4 times\n          for(var i = 0; i < 4; i++) {\n\n            // Choose a random (0-99) photo from the data\n            var randomPhoto = data.photos.photo[_this.getRandomNumber(0, 99)];\n\n            // Construct the photo url\n            var url = _this.constructUrl(randomPhoto);\n\n            // Check if image exist\n            if (_this.doesImageExist(url)) {\n              _this.setTropicalBackground(url, t);\n              break;\n            } else if (i === 3) {\n              _this.setTropicalBackground('img/dist/island-beach.jpg', t);\n            }\n          }\n        }\n\n        $('body').css('overflow','initial');\n        $('#organs').css('opacity',1);\n      }\n\n    });\n\n  },\n\n  doesImageExist: function(url) {\n    var response = false;\n\n    // Make the request to check if exists\n    $.ajax({\n      url: url,\n      async: false,\n    }).complete(function(jqXHR) {\n      // If the photo exists\n      if(jqXHR.status === 200) {\n        response = true;\n      }\n    }).fail(function() {\n      console.log('error');\n    });\n\n    return response;\n  },\n\n  constructUrl: function(photo) {\n    return 'https://farm' + photo.farm + '.staticflickr.com/' + photo.server + '/' + photo.id + '_' + photo.secret + '_h.jpg';\n  },\n\n  setTropicalBackground: function(url, bgNum) {\n    $('#tropical-bg-' + bgNum).attr('xlink:href', url);\n  },\n\n  getRandomNumber: function(min,max) {\n    return Math.floor(Math.random() * max) + min;\n  },\n};\n\nSite.Audio = {\n  init: function() {\n    var _this = this;\n\n    _this.playlistId = '269048127';\n    _this.clientId = 'tlpRScA9YMg119ZZrHZ6lAWCom7Rje9c';\n    _this.playlistJson = 'http://api.soundcloud.com/playlists/' + _this.playlistId + '?client_id=' + _this.clientId;\n\n    _this.getTrack();\n  },\n\n  getTrack: function() {\n    var _this = this;\n\n    $.getJSON(_this.playlistJson, function(data) {\n      if (data) {\n        var tracks = data.tracks;\n        var randomTrack = tracks[Math.floor(Math.random() * tracks.length)];\n        var trackUrl = randomTrack.stream_url + '?client_id=' + _this.clientId;\n\n        _this.addElement(trackUrl);\n      }\n    });\n  },\n\n  addElement: function(url) {\n    var _this = this;\n    var audioElem = '<audio id=\"audio\" src=\"' + url + '\" preload=\"auto\" loop volume=\"1.0\"></audio>';\n\n    $('body').prepend(audioElem);\n    $('#audio').trigger('play');\n\n    _this.bindVolume();\n  },\n\n  bindVolume: function() {\n    var audio = document.getElementById('audio');\n\n    $(window).on('scroll', function() {\n      var volume = (($('#gradient-background').offset().top - $(window).scrollTop()) + $('#gradient-background').height()) / $('#gradient-background').height();\n\n      audio.volume = volume > 0.1 ? volume : 0.1;\n    });\n  },\n};\n\nSite.init();"],"sourceRoot":"/source/"}